<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Machine Learning Algorithm Selection</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    <style>
         #drop-zone {
        border: 2px dashed #007bff;
        border-radius: 5px;
        padding: 20px;
        text-align: center;
        color: #007bff;
        cursor: pointer;
        transition: background-color 0.2s ease-in-out;
        height: 250px; /* Yüksekliği artırmak için bu satırı ekledik */
        display: flex;
        align-items: center;
        justify-content: center;
    }
        #drop-zone.dragover {
            background-color: #e9f5ff;
        }


	#btn-circle {
        width: 30px; /* Adjust the size as needed */
        height: 30px;
        padding: 0;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
	color: #0050FF;
    	}
	
    	#btn-circle i {
        font-size: 25px; /* Adjust icon size */
    	}

        .result-container {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        
        .section {
            margin-bottom: 20px;
        }
        
        .section h3 {
            font-size: 1.5em;
            color: #007BFF;
            border-bottom: 2px solid #007BFF;
            padding-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .section ol {
            padding-left: 20px;
        }
        
        .section li {
            margin: 5px 0;
            font-size: 1.1em;
        }
        
        /* Tooltip container */
        .tooltip-container {
            position: relative;
            display: inline-block;
            cursor: pointer;
        }
        
        /* Tooltip text */
        .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%; /* Position above the icon */
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9em;
        }
        
        /* Tooltip arrow */
        .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #555 transparent transparent transparent;
        }
        
        /* Show tooltip on hover */
        .tooltip-container:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        
        /* Info icon */
        .info-icon {
            font-size: 0.9em;
            color: #007BFF;
            border-radius: 50%;
            padding: 2px;
            background: #f0f8ff;
        }

    </style>
</head>
<body>
<div class="container mt-5">
    <div class="d-flex align-items-center">
        <h1>Machine Learning Algorithm Selection</h1>
        <button id ="btn-circle" type="button" class="btn btn-info btn-sm ms-2" data-bs-toggle="modal" data-bs-target="#infoModal">
            <i class="bi-info-circle"><b>i</b></i></button>
    </div>


    <!-- Modal -->
            <div class="modal fade" id="infoModal" tabindex="-1" aria-labelledby="infoModalLabel" aria-hidden="true">
            <div class="modal-dialog" style="max-width: 60%;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="infoModalLabel">Application Description</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>
                            Selecting the best machine learning algorithm for a given dataset can be a challenging and time-consuming process. The performance of a model depends on numerous factors such as the type of data, its characteristics, and the computational constraints. With so many algorithms to choose from, each with its strengths and weaknesses, identifying the most suitable option can be overwhelming, especially for users without advanced expertise in machine learning.
                        </p>
                        <p>
                            <strong>About This Application:</strong> 
                            This application is designed to simplify the process of selecting machine learning algorithms. By leveraging pre-trained models, we have evaluated various machine learning algorithms across different datasets, analyzing their performance based on metrics such as accuracy, training time, and test time. Using this application, users can upload their datasets and receive algorithm rankings tailored to their data. The system is capable of handling both classification and regression problems, providing a comprehensive solution for users in various domains.
                        </p>
                        <p>
                            <strong>Constraints and Requirements:</strong> 
                            Please ensure your dataset adheres to the following constraints for optimal performance:
                        </p>
                        <ul>
                            <li>
                                <strong>Classification Dataset:</strong> 
                                The dataset must contain exactly one column named <code>Label</code>, which will be treated as the output column. Classification problems can be binary or multi-class with no restrictions on the number of classes.
                            </li>
                            <li>
                                <strong>Regression Dataset:</strong> 
                                The dataset must include at least one output column. Output columns should follow a specific naming convention: <code>output1</code>, <code>output2</code>, etc., where <code>n</code> is an integer starting from 1. For example, the first output column should be named <code>output1</code>, the second <code>output2</code>, and so on.
                            </li>
			     <li>
                                <strong>Automatic Handling of Missing Data:</strong> 
                                The system can automatically detect and handle missing data. Samples containing null values will be dropped to ensure data integrity during processing.
                            </li>
                            <li>
                                <strong>Automatic Encoding of Categorical Variables:</strong> 
                                Any categorical column in the dataset will be automatically encoded into numerical values using <code>LabelEncoder</code>. This ensures compatibility with machine learning algorithms requiring numerical inputs.
                            </li>
                            <li>
                                <strong>Minimum Samples:</strong> 
                                The dataset must contain at least 10 samples. Datasets with fewer samples cannot be processed by the system.
                            </li>
                            <li>
                                <strong>File Format:</strong> 
                                The system supports files in CSV and XLSX formats only. Ensure your dataset is saved in one of these formats before uploading.
                            </li>
                        </ul>
                        <p>
                            <strong>Example Datasets:</strong> 
                            For sample datasets that meet the above requirements, please visit the following link: 
                            <a href="https://drive.google.com/drive/folders/1SobI2rZBYYMx_yt9aF9X34IyK8SKh4hU?usp=drive_link" target="_blank">Download Example Datasets</a>.
                        </p>
                        <p>
                            <strong>Steps to Use This Application:</strong>
                        </p>
                        <ul>
                            <li><strong>File Upload:</strong> Drag and drop a valid CSV or XLSX file into the file zone, or click to select a file.</li>
                            <li><strong>Problem Type:</strong> Use the dropdown to select the type of problem (Regression or Classification).</li>
                            <li><strong>Dataset Area:</strong> Choose the appropriate dataset area (e.g., Health, Tech & Eng, Economic, Social).</li>
                            <li>Click the <strong>Evaluate</strong> button to process the data and receive algorithm recommendations ranked by their performance metrics.</li>
                            <li>Ensure all fields are filled before submission. The evaluate button will remain disabled otherwise.</li>
                        </ul>
                        <p>
                            If you encounter any issues or need assistance, please contact us for further guidance.
                        </p>
                    </div>
                </div>
            </div>
        </div>



    <form id="upload-form" enctype="multipart/form-data">
        <!-- File Drop Zone -->
        <div id="drop-zone" class="mb-3">
            Drag and drop a CSV or XLSX file here, or click to select
            <input type="file" id="file" name="file" accept=".csv, .xlsx" hidden required>
        </div>
        
        <!-- Dropdown Menus -->
        <div class="row mb-3">
            <div class="col-md-6">
                <label for="problem-type" class="form-label">Problem Type</label>
                <select class="form-select" id="problem-type" name="problem-type" required>
                    <option value="">Select a problem type</option>
                    <option value="Regression">Regression</option>
                    <option value="Classification">Classification</option>
                </select>
            </div>
            <div class="col-md-6">
                <label for="dataset-area" class="form-label">Dataset Area</label>
                <select class="form-select" id="dataset-area" name="dataset-area" required>
                    <option value="">Select a dataset area</option>
                    <option value="Health">Health</option>
                    <option value="Technology & Engineering">Technology & Engineering</option>
                    <option value="Economic">Economic</option>
                    <option value="Social">Social</option>
                </select>
            </div>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn btn-primary" id="evaluate-button" disabled>Evaluate</button>
    </form>
    
    <!-- Result Display -->
    <div id="result" class="mt-4"></div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

<script>
    const dropZone = document.getElementById('drop-zone');
    const fileInput = document.getElementById('file');
    const problemTypeDropdown = document.getElementById('problem-type');
    const datasetAreaDropdown = document.getElementById('dataset-area');
    const evaluateButton = document.getElementById('evaluate-button');

    // Handle drag-and-drop
    dropZone.addEventListener('click', () => fileInput.click());
    dropZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropZone.classList.add('dragover');
    });
    dropZone.addEventListener('dragleave', () => dropZone.classList.remove('dragover'));
    dropZone.addEventListener('drop', (e) => {
        e.preventDefault();
        dropZone.classList.remove('dragover');
        const file = e.dataTransfer.files[0];

        // Validate file type
        if (!file.name.endsWith('.csv') && !file.name.endsWith('.xlsx')) {
            alert('Please upload a valid CSV or XLSX file.');
            return;
        }

        fileInput.files = e.dataTransfer.files; // Bind file to the input
        dropZone.textContent = file.name; // Show file name in the zone
        checkFormValidity();  // Check form validity when file is dropped
    });

    fileInput.addEventListener('change', () => {
        const file = fileInput.files[0];
        if (file && !file.name.endsWith('.csv') && !file.name.endsWith('.xlsx')) {
            alert('Please upload a valid CSV or XLSX file.');
            fileInput.value = ''; // Reset the input
            return;
        }
        if (fileInput.files.length > 0) {
            dropZone.textContent = fileInput.files[0].name;
        }
        checkFormValidity();  // Check form validity when file is selected
    });

    // Handle dropdown change events
    problemTypeDropdown.addEventListener('change', checkFormValidity);
    datasetAreaDropdown.addEventListener('change', checkFormValidity);

    // Function to enable/disable the "Evaluate" button based on form validation
    function checkFormValidity() {
        const isFileValid = fileInput.files.length > 0;
        const isProblemTypeValid = problemTypeDropdown.value !== "";
        const isDatasetAreaValid = datasetAreaDropdown.value !== "";

        // Enable or disable the button based on all conditions
        if (isFileValid && isProblemTypeValid && isDatasetAreaValid) {
            evaluateButton.disabled = false;
        } else {
            evaluateButton.disabled = true;
        }
    }

    // Handle form submission
    document.getElementById('upload-form').addEventListener('submit', async (e) => {
        e.preventDefault();

	const resultDiv_ = document.getElementById('result'); // Ensure this matches your result container's ID
    	resultDiv_.innerHTML = `<div class="alert alert-info">Processing your request, please wait...</div>`;

        // Prepare FormData object
        const formData = new FormData();
        const file = fileInput.files[0];
        const problemType = document.getElementById('problem-type').value;
        const datasetArea = document.getElementById('dataset-area').value;

        formData.append('file', file);
        formData.append('problem_type', problemType);
        formData.append('dataset_area', datasetArea);

        // Send data to backend
        const response = await fetch('https://algorithm-selection.onrender.com/evaluate', {
            method: 'POST',
            body: formData
        });

        const result = await response.json();

        // Display results
        const resultDiv = document.getElementById('result');
        if (result.status === 'success') {
    	const resultData = result.data;

	        
        // Create HTML structure
        let listHTML = '<div class="result-container">';
        
        // Dataset Features section (appears first)
        listHTML += '<div class="section">';
        listHTML += '<h3>Dataset Features</h3>';
        listHTML += '<ul>';
        for (const [key, value] of Object.entries(resultData["Dataset Featuers"])) {
            listHTML += `<li><strong>${key}:</strong> ${value}</li>`;
        }
        listHTML += '</ul>';
        listHTML += '</div>';
        
        // Function to add tooltip icon
        function addTooltip() {
            return `
                <span class="tooltip-container">
                    <i class="info-icon">ℹ️</i>
                    <span class="tooltip-text">Order is ascending (lower to higher)</span>
                </span>
            `;
        }
        
        // Accuracy section
        listHTML += '<div class="section">';
        listHTML += `<h3>Accuracy ${addTooltip()}</h3>`;
        listHTML += '<ol>'; // Use <ol> for a numerical list
        resultData["Accuracy"].forEach(item => {
            listHTML += `<li>${item}</li>`;
        });
        listHTML += '</ol>';
        listHTML += '</div>';
        
        // Training Time section
        listHTML += '<div class="section">';
        listHTML += `<h3>Training Time ${addTooltip()}</h3>`;
        listHTML += '<ol>'; // Use <ol> for a numerical list
        resultData["Tarining Time"].forEach(item => {
            listHTML += `<li>${item}</li>`;
        });
        listHTML += '</ol>';
        listHTML += '</div>';
        
        // Test Time section
        listHTML += '<div class="section">';
        listHTML += `<h3>Test Time ${addTooltip()}</h3>`;
        listHTML += '<ol>'; // Use <ol> for a numerical list
        resultData["Test Time"].forEach(item => {
            listHTML += `<li>${item}</li>`;
        });
        listHTML += '</ol>';
        listHTML += '</div>';
        
        listHTML += '</div>';
        
        // Insert the generated HTML into the resultDiv
        resultDiv.innerHTML = listHTML;


	} else {
            resultDiv.innerHTML = `<div class="alert alert-danger">${result.message}</div>`;
        }
    });
</script>
</body>
</html>
